<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Order Metal Card — QFS</title>

<style>
  :root{
    --gold:#d4af37;
    --bg:#ffffff;
    --card:#ffffff;
    --text:#0b1220;
    --muted:#6b7280;
    --accent:#3fa0ff;
    --radius:14px;
    --panel-w:420px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Helvetica Neue", Arial;
    background:var(--bg);
    color:var(--text);
  }

  .wrap {
    max-width:960px;
    margin:28px auto;
    padding:18px;
    display:flex;
    gap:20px;
    align-items:flex-start;
    justify-content:center;
  }

  .visual {
    flex:1 1 520px;
    display:flex;
    flex-direction:column;
    gap:12px;
    align-items:center;
  }

  .card-view {
    width:420px;
    height:auto;
    border-radius:12px;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    background:transparent;
    position:relative;
  }

  .card-img {
    width:100%;
    max-width:420px;
    height:auto;
    object-fit:cover;
    border-radius:8px;
    transition: opacity 0.35s ease;
    opacity:1;
  }

  .title { font-size:18px; font-weight:700; text-align:center; margin-top:6px; }
  .desc { color:var(--muted); text-align:center; font-size:13px; margin-top:4px; }

  .panel {
    width:var(--panel-w);
    background:var(--card);
    border-radius:var(--radius);
    padding:18px;
    border:1px solid rgba(15,20,32,0.04);
    box-shadow: 0 8px 30px rgba(2,6,23,0.04);
    display:flex;
    flex-direction:column;
    gap:10px;
  }

  .heading { font-size:20px; font-weight:800; }
  .sub { color:var(--muted); font-size:13px; }

  label { display:block; font-size:13px; color:var(--muted); margin-top:8px; margin-bottom:6px; }
  select {
    width:100%;
    padding:10px 12px;
    border-radius:10px;
    border:1px solid rgba(15,20,32,0.06);
    background:#fff;
    color:var(--text);
    font-size:15px;
  }

  .pay-now-wrapper { display:flex; justify-content:center; margin-top:20px; }
  .pay-btn {
    padding:14px 32px;
    background:#1a73e8;
    color:white;
    font-size:16px;
    font-weight:600;
    border:none;
    border-radius:8px;
    cursor:pointer;
  }

  .price-box {
    margin-top:12px;
    padding:12px;
    border-radius:10px;
    text-align:center;
    border:1px solid rgba(212,175,55,0.04);
  }

  .usd { font-size:20px; font-weight:800; }
  .btc { margin-top:6px; color:#0b8bd6; font-weight:700; }

  .countdown { text-align:center; color:var(--muted); font-size:13px; }
  .muted { text-align:center; color:var(--muted); font-size:13px; }

</style>
</head>
<body>

<div class="wrap">

  <div class="visual">
    <div class="card-view">
      <img id="cardImage" class="card-img"
      src="https://raw.githubusercontent.com/qfsnesaragesara/BTC-METAL-CARD-PAYMENT/main/GoldCard.png">
    </div>

    <div class="title">Physical Metal Bitcoin Access Card</div>
    <div class="desc">Premium laser-etched metal card with QR activation.</div>
  </div>

  <div class="panel">

    <div class="heading">Order Details</div>
    <div class="sub">Select card type and quantity.</div>

    <label for="cardType">Card Type</label>
    <select id="cardType">
      <option value="black">Black — $1,000</option>
      <option value="gold" selected>Gold — $750</option>
      <option value="silver">Silver — $500</option>
    </select>

    <label for="quantity">Quantity</label>
    <select id="quantity">
      <option>1</option><option>2</option><option>3</option><option>4</option>
      <option>5</option><option>6</option><option>7</option><option>8</option>
      <option>9</option><option>10</option>
    </select>

    <div class="price-box">
      <div class="usd" id="totalUSD">$0</div>
      <div class="btc" id="totalBTC">0 BTC</div>
      <div id="btcPriceLine">BTC Price: Loading…</div>
    </div>

    <div class="countdown">Discount ends in: <span id="countdown">--:--:--</span></div>

    <div class="pay-now-wrapper">
      <button id="payNow" class="pay-btn">Pay Now</button>
    </div>

    <div class="muted">You will be redirected to the BTC payment page.</div>
  </div>

</div>

<script>
/* ========== CONFIG ========= */
const IMAGES = {
  black: "https://raw.githubusercontent.com/qfsnesaragesara/BTC-METAL-CARD-PAYMENT/main/BlackCard.png",
  gold:  "https://raw.githubusercontent.com/qfsnesaragesara/BTC-METAL-CARD-PAYMENT/main/GoldCard.png",
  silver:"https://raw.githubusercontent.com/qfsnesaragesara/BTC-METAL-CARD-PAYMENT/main/SilverCard.png"
};

const BASE_PRICES = { black:1000, gold:750, silver:500 };
const INCREASED_PRICES = { black:1250, gold:1000, silver:750 };
const WALLET_ADDR = "bc1qqla2r8dmmvefq9svus0kv098nnvudsehpzmut8";

/* ========== ELEMENTS ========= */
const cardImage = document.getElementById("cardImage");
const cardTypeEl = document.getElementById("cardType");
const qtyEl = document.getElementById("quantity");
const totalUSDEl = document.getElementById("totalUSD");
const totalBTCEle = document.getElementById("totalBTC");
const btcPriceLine = document.getElementById("btcPriceLine");
const countdownEl = document.getElementById("countdown");
const payNowBtn = document.getElementById("payNow");

/* ========== BTC PRICE ========= */
let currentBtcPrice = null;

async function fetchBtcPrice(){
    try {
        const res = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd");
        const json = await res.json();
        currentBtcPrice = Number(json.bitcoin.usd);
        btcPriceLine.innerText = "BTC Price: $" + currentBtcPrice.toLocaleString();
        updateTotals();
    } catch {
        btcPriceLine.innerText = "BTC Price unavailable";
    }
}
fetchBtcPrice();

/* ========== COUNTDOWN ========= */
const END_KEY = "qfs_order_end_ts";
function getOrCreateEndTs(){
  const existing = localStorage.getItem(END_KEY);
  if(existing) return Number(existing);
  const ts = Date.now() + 48*3600*1000;
  localStorage.setItem(END_KEY, ts);
  return ts;
}
let endTs = getOrCreateEndTs();

function runCountdown(){
  const diff = endTs - Date.now();
  if(diff <= 0) {
    countdownEl.innerText = "Expired";
    return true;
  }
  const h = Math.floor(diff/3600000);
  const m = Math.floor((diff%3600000)/60000);
  const s = Math.floor((diff%60000)/1000);
  countdownEl.innerText = `${h}h ${m}m ${s}s`;
  return false;
}
setInterval(runCountdown, 1000);
runCountdown();

/* ========== PRICE ========= */
function getPriceMap(){
  return (Date.now() >= endTs) ? INCREASED_PRICES : BASE_PRICES;
}

function updateTotals(){
  const type = cardTypeEl.value;
  const qty = Number(qtyEl.value);
  const priceMap = getPriceMap();
  const usd = priceMap[type] * qty;

  totalUSDEl.innerText = "$" + usd.toLocaleString();

  if (currentBtcPrice) {
    const btc = (usd / currentBtcPrice).toFixed(8);
    totalBTCEle.innerText = btc + " BTC";
  }
}

cardTypeEl.addEventListener("change", () => {
  cardImage.src = IMAGES[cardTypeEl.value];
  updateTotals();
});
qtyEl.addEventListener("change", updateTotals);

updateTotals();

/* ========== PAY NOW ========= */
payNowBtn.addEventListener("click", () => {
  const type = cardTypeEl.value;
  const qty = Number(qtyEl.value);

  const priceMap = getPriceMap();
  const usd = priceMap[type] * qty;

  const btc = currentBtcPrice ? (usd / currentBtcPrice).toFixed(8) : "";

  const params = new URLSearchParams({
    type,
    qty,
    usd,
    btc,
    addr: WALLET_ADDR
  });

  window.location.href = "wallet.html?" + params.toString();
});
</script>

</body>
</html>
